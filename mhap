==Introduction==
:''CANU'' includes a de novo correction module, using ''MHAP'' to align long reads against themselves and ''pbdagcon'' to correct the long reads by a consensus step.

Website : https://github.com/marbl/canu

==Installation==
:''Canu'' is designed to run on grid environments (LSF/PBS/Torque/Slrum/SGE are supported) and requires java 1.8 and gnuplot.

Install ''Canu'' :

    $ git clone https://github.com/marbl/canu.git
    $ cd canu/src
    $ make -j <nombre de threads>

==Input data==
:''Canu'' requires only long reads in FASTA or FASTQ format.

==Pipeline==
:Start the long reads correction correction with the "canu" binary, located in the folder “canu/Linuxamd64/bin”:

    $ ./canu -correct -p ecoli -d ecoli genomeSize=4.8m -pacbio-raw longs-reads.fastq

:<b>genomeSize</b>: Genome size
:<b>pacbio-raw</b>: Type of long reads (pacbio-raw or naopore-raw)

It is also possible to isolate the corrected sequences with the "canu" binay:

    $ ./canu -trim -p ecoli -d ecoli genomeSize=4.8m -pacbio-corrected corrected-reads.fastq

Canu corrects long reads in two steps:

:*At first, ''MHAP'' finds inaccurate overlaps between long reads.
:*''Pbdagcon'' then builds a consensus sequence from these overlaps.

==Encountered errors==
:<b>Error</b>: canu failed with 'can't configure for SGE'}

<b>solution</b>: Add the following arguments in the command line:
:gridEngineMemoryOption="-l h\_vmem=MEMORY" 
:gridEngineThreadsOption="-pe make THREADS"

==Output data==
:The corrected sequences will be stored in multiple FASTA files concatenated in the output folder:
"correction/2-correction/correction_outputs"

==Correction evaluation==
Dataset:

{| class="wikitable"
|-
!Reference genome
|Escherichia coli k-12 MG1655 1 chromosome (4 641 652 pb)
|-
!Pacbio reads (P6C4)
|87497 raw reads (100x coverage)
|-
!Illumina reads (MiSeq)
|16759877 reads (2x150pb)
|}

The reference genome is used to evaluate long reads correction, based on metrics produced by Blasr alignments before the assembly and by the QUAST software after the assembly.

''Blasr'' alignment metrics:

:<b>Size</b>: The sum of the length of the corrected long reads, divided by the length of uncorrected long reads.

:<b>Execution time</b>: Corrector execution time.

:<b>% mapped region</b>: Proportion of corrected reads that \emph{BLASR} succeeded in mapping to the reference genome.

:<b>Mean number of match</b>:  The average number of match per long read.

:<b>% identity</b>: Percentage of identity given by \emph{BLASR} for the region of long read that could be aligned.

''Quast'' metrics:

:<b># contigs (> 1000pb)</b>: Total number of contigs exceeding 1000 bp after assembly.

:<b>Total length</b>: Assembly length.

:<b>N50</b>: Length for which the collection of all contigs of this length or greater, covers at least half of the assembly.

:<b>Genome fraction (\%)</b>: the percentage of aligned bases in the reference genome.

The assembly step is performed by ''Smartdenovo''.

{| class="wikitable"
|-
!Metrics (Blasr, Quast)
!MHAP correction
|-
!Size
|21.16
|-
!Execution time
|7 380s
|-
!% mapped region
|99.6
|-
!Mean number of match
|6 381
|-
!% identity
|98.8
|-
!# contigs (>=1000pb)
|1
|-
!N50
|4 646 370
|-
!Total length
|4 646 370
|-
!Genome fraction
|99.99
|}

More assembly results can be found at

